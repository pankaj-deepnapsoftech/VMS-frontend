import { createContext, useEffect, useState } from "react";
import { useAuthContext } from "..";
import { AxiosHandler } from "@/config/AxiosConfig";



export const ApplicationVulnerabilityContext = createContext();

const ApplicationVulnerabilityContextProvider = ({ children }) => {





	const { token } = useAuthContext()
	const [loading, setLoading] = useState(false);

	const [criticalHighVulnerableItemsData, setCriticalHighVulnerableItemsData] = useState([])

	const [criticalHighVulnerableOverdueItemsData, setCriticalHighVulnerableOverdueItemsData] = useState([])

	const [lowMediumVulnerableItems, setLowMediumVulnerableItemsData] = useState([])

	const [lowMediumVulnerableItemsOverdue, setLowMediumVulnerableItemsOverdueData] = useState([])

	const [applicationvulnerabilityCardData, setApplicationvulnerabilityCardData] = useState([])




	const CriticalHighVulnerableItems = async () => {
		setLoading(true);
		try {

			const res = await AxiosHandler.get("/data/CriticalHighVulnerableItems");
			setCriticalHighVulnerableItemsData(res.data?.results);
		} catch (error) {
			console.log(error)
		} finally {
			setLoading(false);
		}
	}


	const CriticalHighVulnerableOverdueItems = async () => {
		setLoading(true);
		try {

			const res = await AxiosHandler.get("/data/CriticalHighVulnerableItemsOverdue");
			setCriticalHighVulnerableOverdueItemsData(res.data?.results);
		} catch (error) {
			console.log(error)
		} finally {
			setLoading(false);
		}
	}


	const LowMediumVulnerableItems = async () => {
		setLoading(true);
		try {

			const res = await AxiosHandler.get("/data/LowMediumVulnerableItems");
			setLowMediumVulnerableItemsData(res.data?.results);
		} catch (error) {
			console.log(error)
		} finally {
			setLoading(false);
		}
	}


	const LowMediumVulnerableItemsOverdue = async () => {
		setLoading(true);
		try {

			const res = await AxiosHandler.get("/data/LowMediumVulnerableItemsOverdue");
			setLowMediumVulnerableItemsOverdueData(res.data?.results);

		} catch (error) {
			console.log(error)
		} finally {
			setLoading(false);
		}
	}

	const ApplicationvulnerabilityCardData = async () => {
		setLoading(true);
		try {

			const res = await AxiosHandler.get("/data/ApplicationvulnerabilityCardData");
			setApplicationvulnerabilityCardData(res.data);
		} catch (error) {
			console.log(error)
		} finally {
			setLoading(false);
		}
	}


	useEffect(() => {
		if (token) {
			CriticalHighVulnerableItems();
			CriticalHighVulnerableOverdueItems();
			LowMediumVulnerableItems();
			LowMediumVulnerableItemsOverdue();
			ApplicationvulnerabilityCardData();
		}
	}, [token])

	return (
		<ApplicationVulnerabilityContext.Provider value={{
			loading,
			criticalHighVulnerableItemsData,
			criticalHighVulnerableOverdueItemsData,
			lowMediumVulnerableItems,
			lowMediumVulnerableItemsOverdue,
			applicationvulnerabilityCardData

		}}>
			{children}
		</ApplicationVulnerabilityContext.Provider>
	)
}


export default ApplicationVulnerabilityContextProvider